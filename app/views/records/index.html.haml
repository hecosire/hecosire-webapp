- content_for(:title, "Records")

%h1 How are you feeling?

%a{:href => new_record_path, :rel => 'nofollow'}
  %button.btn.btn-primary
    New Record

- unless @records.empty?
  .container
    .row
      .col-xs-12
        %h1 How you felt..

        #chart-time
    .row
      .col-xs-12.col-sm-6

        %table.table
          %thead
            %tr
              %th Date
              %th Health state
              %th
              %th
              %th

          %tbody
            - @records.each do |record|
              %tr
                %td
                  = time_ago_in_words(record.created_at)
                  ago
                %td= record.health_state
                %td= link_to 'Show', record
                %td= link_to 'Edit', edit_record_path(record)
                %td= link_to 'Destroy', record, :method => :delete, :data => { :confirm => 'Are you sure?' }

        = will_paginate @records
        %br
      .col-xs-12.col-sm-6
        #chart
- content_for :javascript do
  :javascript
    $(function(){
      var chart = c3.generate({
            bindto: '#chart',
            data: {
              columns: [
                ['Healthy', #{@stats[:healthy]}],
                ['Coming down', #{@stats[:coming_down]}],
                ['Sick', #{@stats[:sick]}],
                ['Recovering', #{@stats[:recovering]}]
              ],
              type: 'pie'
            },
        });

      var chart2 = c3.generate({
        bindto: '#chart-time',
        data: {
            x: 'x',
            xFormat: '%Y-%m-%d %I:%M', // 'xFormat' can be used as custom format of 'x'
            columns: [
                ['x',
                #{@dates_for_timechart}
                ],
                ['y',
                #{@states_for_timechart}
                ]

            ]
        },
        grid: {
          y: {
            lines: [
            {value: 3.99, text: 'Healthy'} ,
            {value: 2.99, text: 'Recovering'},
            {value: 1.99, text: 'Coming down'},
            {value: 0.99, text: 'Sick'}
            ]
         }
        },
        axis: {
            x: {
                type: 'timeseries',
                tick: {
                    format: '%Y-%m-%d %I:%M',
                    rotate: 40
                },

            },
            y: {
            tick: {
               values: [1, 2, 3, 4]
            }
          }
        }
    });
    });